+++
date = "2016-03-20T21:37:12+03:00"
title = "Прототип на Hugo"
description = "Как поднять собственный блог с помощью Hugo?"
step = "2.2"
author = "Александр Елисеев"
+++

Я продолжаю создание [иерархической платформы для блогов по методологии Lean](/lispress/1-hypothesis/). Из [шага 2](/lispress/2-blog-engine/), вы знаете, что я уже понял, что мне не нужна CMS, тем не менее, на [шаге 2.1](/lispress/2.1-ghost/) я рассказываю про то, как я поднимал Ghost, то есть, про самую первую версию сайта. 

Я очень хотел простоты, и я нашёл [Hugo](gohugo.io). Это даже не платформа, а просто генератор статических сайтов. И, дойдя до него, я познал дзен. Я хотел слишком многого от блога, на самом деле, мне нужна просто утилитка, которая сгенерит мне статический сайтик. А всё, что я хочу, вроде аналитики, платформы для написания статей и прочих плюшек — может быть реализовано в виде внешних сервисов.

Я поднял среду для разработки фронтенда, статически сверстал главную страницу, перенёс вёрстку в новую тему Hugo, поковырялся в настройках темы, сделал её слегка динамичнее, поднял виртуалку, настроил сервер, и всё готово. Дальше обо всём по порядку.

## Настройка среды для создания сайтов

Я решил начать с просмотра того, как верстают опытные люди, и наткнулся на этого [блоггера](https://www.youtube.com/user/agragregra). Мне понравился его курс, особенно подход к созданию рабочей среды. Я адаптировал под себя [его шаблон](https://www.youtube.com/watch?v=4e7_zaNNIlU). Чтобы сверстать статический сайт с главной страницей. Подробнее о дизайне главной страницы я расскажу на шаге 3.

## Создание темы для Hugo

Когда я получил версию, которая мне понравилась, я решил перенести её в новую тему Hugo.

Я не буду писать о том, как просто создать новый сайт на Hugo, об этом замечательно написано в [Quick Guide](http://gohugo.io/overview/quickstart/) в официальной документации. Я даже не буду писать подробно о командах, которые нужно применить, чтобы сгенерировать базовый шаблон для темы, это тоже [отлично описано в официальной документации](http://gohugo.io/themes/creation/). Я расскажу о своём опыте и своих впечатлениях. Я скачал парочку тем: [hugo-cactus-theme](http://themes.gohugo.io/cactus/) и [hugo-uno](http://themes.gohugo.io/hugo-uno/), чтобы было, откуда черпать вдохновение.

Предположим, что теперь всё готово, мы установили Hugo, скачали парочку тем, создали шаблон и хотим создать нашу новую тему. Всё очень просто, для этого нужно изменить шаблон главной страницы, то есть файл `layouts/index.html`, ([мой](https://github.com/eliseealex/hugo-lis/blob/47746e85668471c42f633caa95c10e99b416dc60/layouts/index.html)) и шаблон для статьи, файл `layouts/_default/single.html`, ([мой](https://github.com/eliseealex/hugo-lis/blob/47746e85668471c42f633caa95c10e99b416dc60/layouts/_default/single.html)). Если вы посмотрите мои файлы, то увидите, как я использовал грязный хак и вручную прописал все ссылки до статей. Я считаю, что на первом этапе — в этом нет ничего плохого. Тем не менее, я решил сделать страницы слегка динамичнее и применить некоторые стандартные переменные Hugo, если что, он берёт их из `config.toml` основного сайта [мой конфиг](https://github.com/eliseealex/lis.press.hugo/blob/1402f624ebaa0d82ee23a9ac8645083948a2d31c/config.toml).


## Настройка среды для создания сайтов с помощью Hugo

К этому моменту я понял, что в Hugo мне тоже нужен автоматический постпроцессинг SASS и перезагрузка страницы после изменений. У него есть своя автоматическая перезагрузка страницы по изменению файлов, поэтому мне пришлось немножко поразбираться со скриптом Gulp для статического сайта и адаптировать его для Hugo. 

Оказывается, что всё, что делает Gulp — это следит за изменением файлов в указанных файлах, запускает постпроцессинг Sass и минификацию Css и Jss и сохраняет эти файлы в указанные в скрипте папки. Также после любых изменений он даёт команду перезагрузки браузеру, и страница обновляется. Всё очень просто. Вторая часть скрипта уже реализована в виде Live Reload в Hugo, так что я её просто выкинул. Остались только препроцессинг Sass и минификация ([мой скрипт](https://github.com/eliseealex/hugo-lis)).

## Деплой приложения

До этого я деплоил приложения через Apache Server в предустановленных образах систем. Но, тем не менее, из-за того, что мне приходилось каждый раз в конфигах прописывать вручную SSL-сертификаты, я разобрался, как настраивается Http-сервер.

Я поднял ещё одну виртуалку на DigitalOcean, установил hugo и git, залил локальную версию Hugo-сайта в гит, склонировал репозиторий на виртуалку, включил сервер hugo, и всё заработало ^^ Кайф. И всё благодаря [одному гайду](https://www.digitalocean.com/community/tutorials/how-to-install-and-use-hugo-a-static-site-generator-on-ubuntu-14-04).

Оставалось только добавить SSL. Но оказалось, что встроенный сервер Hugo его не поддерживает и вообще должен использоваться только для разработки. На случай продакшена Hugo просто генерит все файлы статически, и их можно раздавать с помощью любого веб-сервера. На этот раз я решил использовать NginX, коллеги мне сказали, что он значительно быстрее Apache. Я посмотрел Benchmark’и и согласился. Всё оказалось очень просто.

Для установки NginX я использовал эти гайды:

- [Как установить NginX на убунту 14.04 lts](https://www.digitalocean.com/community/tutorials/how-to-install-nginx-on-ubuntu-14-04-lts);
- [Как настроить виртуальный сервер с помощью NginX](https://www.digitalocean.com/community/tutorials/how-to-set-up-nginx-server-blocks-virtual-hosts-on-ubuntu-14-04-lts);
- [Как установить коммерческий SSL-сертификат](https://www.digitalocean.com/community/tutorials/how-to-install-an-ssl-certificate-from-a-commercial-certificate-authority#nginx).

Надеюсь, что этой статьёй я закончу [второй шаг](/lispress/2-blog-engine/) и дальше буду использовать Hugo. Мне очень нравится этот движок для блогов, и пока что он мне полностью подходит. В следующей статье я расскажу вам про дизайн главной страницы.